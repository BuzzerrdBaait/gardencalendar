<!DOCTYPE html>

<html lang="en">

<head>

    {% load static %}

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Dynamic Calendar</title>

    {{month_info}}

    <style>

        table {

            border-collapse: collapse;

            width: 100%;

        }

        th, td {

            border: 1px solid black;

            padding: 8px;

            text-align: center;

        }

        .month-year {

            text-align: center;

            font-size: 1.2em;

            margin-bottom: 10px;

        }

    </style>

</head>

<body>

<form>

    <input type="button" value="Previous Month" onclick="previousMonth()">

    <span id="monthYear" class="month-year"></span>

    <input type="button" value="Next Month" onclick="nextMonth()">

    <input type="button" value="Generate Calendar" onclick="generateCalendar()">

</form>

{{todays_index}}

{{today_is}}

<table id="calendarTable">

    <thead>

        <tr>

            <th>Monday</th>

            <th>Tuesday</th>

            <th>Wednesday</th>

            <th>Thursday</th>

            <th>Friday</th>

            <th>Saturday</th>

            <th>Sunday</th>

        </tr>

    </thead>

    <tbody>

    </tbody>

</table>

<script>

const monthDictionary= {

    1: 'January',

    2: 'February',

    3: 'March',

    4: 'April',

    5: 'May',

    6: 'June',

    7: 'July',

    8: 'August',

    9: 'September',

    10: 'October',

    11: 'November',

    12: 'December'

};

const dayDictionary = {

    0: 'Monday',

    1: 'Tuesday',

    2: 'Wednesday',

    3: 'Thursday',

    4: 'Friday',

    5: 'Saturday',

    6: 'Sunday'

};

let lastYear = new Date().getFullYear() - 1;

let year = new Date().getFullYear();

let currentMonthIndex = new Date().getMonth(); // Set to current month index

let blankDays = [];

let numDaysInMonth = [];

let correlatingYear = [];

let strMonth = [];

let datesListList = [];

// Call the function to calculate month data

calculateMonthData();
generateCalendar();

// Function to calculate month-related data

function calculateMonthData() {

    blankDays = [];

    numDaysInMonth = [];

    correlatingYear = [];

    strMonth = [];

    datesListList = [];

    for (let i = 0; i < 12; i++) { // Start from 0 to match month index

        const monthInfo = new Date(lastYear, i + 1, 0); // Increment month by 1

        const blankDaysCount = new Date(lastYear, i, 1).getDay();

        const numDays = monthInfo.getDate();

        blankDays.push(blankDaysCount);

        numDaysInMonth.push(numDays);

        correlatingYear.push(lastYear);

        strMonth.push(monthDictionary[i + 1]); // Increment month by 1

        const datesList = [];

        for (let day = 1; day <= numDays; day++) {

            const date = new Date(lastYear, i, day); // Increment month by 1

            const dateString = date.toISOString().split('T')[0];

            datesList.push(dateString);

        }

        datesListList.push(datesList);

    }

}

function previousMonth() {

    currentMonthIndex--;

    if (currentMonthIndex < 0) {

        currentMonthIndex = 11;

        lastYear--;

    }

    generateCalendar();

}

function nextMonth() {

    currentMonthIndex++;

    if (currentMonthIndex > 11) {

        currentMonthIndex = 0;

        lastYear++;

    }

    generateCalendar();

}

function generateCalendar() {

    const numRows = Math.ceil((blankDays[currentMonthIndex] + numDaysInMonth[currentMonthIndex]) / 7);

    const tableBody = document.querySelector('#calendarTable tbody');

    tableBody.innerHTML = '';

    let cellNum = 1 - blankDays[currentMonthIndex];

    document.getElementById('monthYear').textContent = `${strMonth[currentMonthIndex]} ${lastYear}`;

    for (let i = 0; i < numRows; i++) {

        const row = document.createElement('tr');

        for (let j = 0; j < 7; j++) {

            const cell = document.createElement('td');

            if (cellNum > 0 && cellNum <= numDaysInMonth[currentMonthIndex]) {

                cell.textContent = cellNum;

            }

            row.appendChild(cell);

            cellNum++;

        }

        tableBody.appendChild(row);

    }

}

</script>

</body>

</html>

